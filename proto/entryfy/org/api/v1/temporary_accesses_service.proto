syntax = "proto3";

package entryfy.org.api.v1;
import "google/protobuf/timestamp.proto";
import "entryfy/org/api/v1/entities.proto";

//option go_package = "github.com/entryfy/org/api/v1;org-api";
option java_multiple_files = true;
option java_package = "com.entryfy.org.api.v1";
option csharp_namespace = "Entryfy.Org.Api.V1";
option ruby_package = "Entryfy::Org::Api::V1";

service TemporaryAccessesService {
    rpc GetTemporaryAccesses (GetTemporaryAccessesRequest) returns (GetTemporaryAccessesResponse) {
    }
    rpc CreateTemporaryAccesses (CreateTemporaryAccessesRequest) returns (CreateTemporaryAccessesResponse) {
    }
    rpc UpdateTemporaryAccesses (UpdateTemporaryAccessesRequest) returns (UpdateTemporaryAccessesResponse) {
    }
    rpc DeleteTemporaryAccesses (DeleteTemporaryAccessesRequest) returns (DeleteTemporaryAccessesResponse) {
    }
}

message GetTemporaryAccessesRequest {
    string organization_slug = 1;
    repeated string uuids = 2; // Send empty array to get all organization temporary accesses
}

message GetTemporaryAccessesResponse {
    repeated TemporaryAccess temporary_accesses = 1;
}

message Guest {
    string email = 1; // Mandatory
    string first_name = 2; // Optional
    string last_name = 3; // Optional
}

message TemporaryAccessUserContainer {
    string user_uuid = 1;
}

message TemporaryAccessDoorContainer {
    string security_device_uuid = 1;
    bool lock_unlock_enabled = 2;
    repeated string in_auth_types = 3;
    repeated string out_auth_types = 4;
}

message TemporaryAccessBody {
    string uuid = 1; // Would be autogenerated on create if not set
    string name = 2;
    map<string, string> preferences = 3;
    google.protobuf.Timestamp valid_from = 4;
    google.protobuf.Timestamp valid_to = 5;
    string schedule_definition = 6;
    string schedule_exception_definition = 7;
    repeated Guest guests = 8;
    repeated TemporaryAccessDoorContainer doors = 9;
    repeated TemporaryAccessUserContainer users = 10;
}

message CreateTemporaryAccessesRequest {
    string organization_slug = 1;
    repeated TemporaryAccessBody temporary_access_bodies = 2;
}

message CreateTemporaryAccessesResponse {
    repeated BizOperation biz_operations = 1;
}

message UpdateTemporaryAccessesRequest {
    string organization_slug = 1;
    repeated TemporaryAccessBody temporary_access_bodies = 2;
}

message UpdateTemporaryAccessesResponse {
    repeated BizOperation biz_operations = 1;
}

message DeleteTemporaryAccessesRequest {
    string organization_slug = 1;
    repeated string uuids = 2;
}

message DeleteTemporaryAccessesResponse {
    repeated BizOperation biz_operations = 1;
}